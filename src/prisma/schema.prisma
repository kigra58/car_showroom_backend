// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// npx prisma generate
// migrateCommand: npx prisma migrate dev --name init
// npx prisma db push
// npx prisma migrate dev --create-only

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int           @id @default(autoincrement())
  first_name   String
  last_name    String
  email        String        @unique
  phone        String        @unique
  password     String
  created_at   DateTime      @default(now())
  updated_at   DateTime      @default(now())
  account_type String
  address      UserAddress[]
  UserPayment  UserPayment[]
}

model UserAddress {
  id       Int    @id @default(autoincrement())
  user_id  Int
  line1    String
  landmark String
  state    String
  city     String
  street   String
  zip_code String
  user     User   @relation(fields: [user_id], references: [id])
}

model Car {
  id               Int    @id @default(autoincrement())
  model            String
  color            String
  manufacture_year String
  created_at   DateTime      @default(now())
}

enum BookingStatus {
  success
  failled
  pending
  refund_intiate
  refunded
}
model Booking {
  id               Int    @id @default(autoincrement())
  user_id          Int
  agent_id         Int
  address_id       Int
  car_id           Int
  down_payment     Int
  payment_id       Int
  created_at       DateTime      @default(now())
  status           BookingStatus
}


enum PaymentStatus {
  initiate
  success
  failled
  pending
  refund_intiate
  refunded
}


enum PaymentMode {
  CASH
  CREDIT_CARD
  DEBIT_CARD
  NET_BANKING
  UPI
}

model UserPayment {
  id             Int           @id @default(autoincrement())
  user_id        Int
  transaction_id String        @unique
  method         PaymentMode
  status         PaymentStatus // initiate,success,failled ,pending,refund_intiate,refunded
  amount         Int
  created_at     DateTime      @default(now())
  updated_at     DateTime      @default(now())
  user           User          @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

